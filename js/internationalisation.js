'use strict';if(typeof module!=='undefined'&&module!==null&&eval('typeof require')!=='undefined'&&eval('require')!==null&&'main'in eval('require')&&eval('typeof require.main')!=='undefined'&&eval('require.main')!==null){var ORIGINAL_MAIN_MODULE=module;if(module!==eval('require.main')&&'paths'in module&&'paths'in eval('require.main')&&typeof __dirname!=='undefined'&&__dirname!==null)module.paths=eval('require.main.paths').concat(module.paths.filter(function(path){return eval('require.main.paths').includes(path)}))};if(typeof window==='undefined'||window===null)var window=(typeof global==='undefined'||global===null)?{}:global;!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("@babel/runtime/helpers/asyncToGenerator"),require("@babel/runtime/helpers/inheritsLoose"),require("@babel/runtime/regenerator"),require("clientnode"));else if("function"==typeof define&&define.amd)define(["@babel/runtime/helpers/asyncToGenerator","@babel/runtime/helpers/inheritsLoose","@babel/runtime/regenerator","clientnode"],t);else{var n="object"==typeof exports?t(require("@babel/runtime/helpers/asyncToGenerator"),require("@babel/runtime/helpers/inheritsLoose"),require("@babel/runtime/regenerator"),require("clientnode")):t(e["@babel/runtime/helpers/asyncToGenerator"],e["@babel/runtime/helpers/inheritsLoose"],e["@babel/runtime/regenerator"],e.clientnode);for(var o in n)("object"==typeof exports?exports:e)[o]=n[o]}}(this,(function(e,t,n,o){return function(){"use strict";var r=[,function(t){t.exports=e},function(e){e.exports=t},function(e){e.exports=n},function(e){e.exports=o}],a={};function i(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={exports:{}};return r[e](n,n.exports,i),n.exports}i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,{a:t}),t},i.d=function(e,t){for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return function(){i.r(s),i.d(s,{Internationalisation:function(){return d}});var e=i(1),t=i.n(e),n=i(2),o=i.n(n),r=i(3),a=i.n(r),l=i(4),u=i.n(l);function c(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}var d=function(e){function n(){for(var t,n=arguments.length,o=Array(n),r=0;r<n;r++)o[r]=arguments[r];return(t=e.call.apply(e,[this].concat(o))||this).$domNodes=null,t.currentLanguage="enUS",t.knownTranslations={},t.lock=new l.Lock,t.options=null,t._$domNodeToFade=null,t._replacements=[],t._textNodesWithKnownTranslation={},t}o()(n,e);var r=n.prototype;return r.initialize=function(t){var o=this;void 0===t&&(t={}),e.prototype.initialize.call(this,u().extend(!0,{},n._defaultOptions,t)),this.options.preReplacementLanguagePattern=u().stringFormat(this.options.preReplacementLanguagePattern,this.options.replacementLanguagePattern.substr(1,this.options.replacementLanguagePattern.length-2)),this.options.lockDescription=u().stringFormat(this.options.lockDescription,this.options.name),this.options.sessionDescription=u().stringFormat(this.options.sessionDescription,this.options.name),this.$domNodes=this.grabDomNodes(this.options.domNodes,this.$domNode),this.$domNodes.switchLanguageButtons=(0,l.$)('a[href^="#'+this.options.languageHashPrefix+'"]'),this._movePreReplacementNodes(),this.currentLanguage=this._normalizeLanguage(this.options.default);var r=this._determineUsefulLanguage();return this.on(this.$domNodes.switchLanguageButtons,"click",(function(e){return e.preventDefault(),o.switch((0,l.$)(e.target).attr("href").substr(o.options.languageHashPrefix.length+1))})),this.currentLanguage===r?(this._switchCurrentLanguageIndicator(r),Promise.resolve(this.$domNode)):this.switch(r,!0)},r.switch=function(){var e=t()(a().mark((function e(t,n){var o,r,i,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n=!1),!0===t||!this.options.selection.length||this.options.selection.includes(t)){e.next=4;break}return this.debug('"{1}" isn\'t one of the allowed languages.',t),e.abrupt("return",this.$domNode);case 4:return e.next=6,this.lock.acquire(this.options.lockDescription);case 6:if(!0===t?(n=!0,t=this.currentLanguage):t=this._normalizeLanguage(t),!(n&&t!==this.options.default||this.currentLanguage!==t)){e.next=21;break}return o="Switch to",n&&(o="Ensure"),this.debug('{1} "{2}".',o,t),this._switchCurrentLanguageIndicator(t),e.next=14,this.fireEvent(n?"ensure":"switch",!0,this,this.currentLanguage,t);case 14:return this._$domNodeToFade=null,this._replacements=[],r=this._collectTextNodesToReplace(t,n),i=r[0],s=r[1],this._ensureLastTextNodeHavingLanguageIndicator(i,s,n),e.next=20,this._handleSwitchEffect(t,n);case 20:return e.abrupt("return",this.$domNode);case 21:return this.debug('"{1}" is already current selected language.',t),this.lock.release(this.options.lockDescription),e.abrupt("return",this.$domNode);case 24:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.refresh=function(){return this._movePreReplacementNodes(),this.switch(!0)},r._handleSwitchEffect=function(){var e=t()(a().mark((function e(t,n){var o,r,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.currentLanguage,n||!this.options.fadeEffect||!this._$domNodeToFade){e.next=12;break}return e.next=4,(r=this._$domNodeToFade).animate.apply(r,this.options.textNodeParent.hideAnimation).promise();case 4:if(this._switchLanguage(t),!this._$domNodeToFade){e.next=11;break}return e.next=8,(i=this._$domNodeToFade).animate.apply(i,this.options.textNodeParent.showAnimation).promise();case 8:return e.next=10,this.fireEvent(n?"ensured":"switched",!0,this,o,t);case 10:this.lock.release(this.options.lockDescription);case 11:return e.abrupt("return");case 12:return this._switchLanguage(t),e.next=15,this.fireEvent(n?"ensured":"switched",!0,this,o,t);case 15:this.lock.release(this.options.lockDescription);case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r._movePreReplacementNodes=function(){var e=this;this.$domNode.find(":not(iframe)").contents().each((function(){var t=(0,l.$)(this),n=t.prop("nodeName").toLowerCase();if(e.options.replacementDomNodeName.includes(n)){["#comment","#text"].includes(n)||t.hide();var o=new RegExp(e.options.preReplacementLanguagePattern),r=t.prop("textContent").match(o);if(r&&r[0]){t.prop("textContent",t.prop("textContent").replace(o,r[1]));var a=!1;t.parent().contents().each((function(){return a&&(0,l.$)(this).Tools("text").trim()?(t.appendTo(this),!1):void(t[0]===this&&(a=!0))}))}}}))},r._collectTextNodesToReplace=function(e,t){var n=null,o=null,r=null,a=null;this.knownTranslations={};var i=this;return this.$domNode.find(":not(iframe)").contents().each((function(){var s=(0,l.$)(this),u=s.prop("nodeName").toLowerCase();if(i.options.replaceDomNodeNames.includes(u.toLowerCase()))s.Tools("text").trim()&&0===s.parents(i.options.replaceDomNodeNames.join()).length&&(a=i._ensureLastTextNodeHavingLanguageIndicator(r,a,t),n=s);else if(n){if(i.options.replacementDomNodeName.includes(u)){var c=s.prop("textContent");"#comment"!==u&&(c=s.html());var p=c.match(new RegExp(i.options.replacementLanguagePattern));return void(Array.isArray(p)&&p[1]===e?(i.knownTranslations[n.Tools("text").trim()]=p[2].trim(),i._registerTextNodeToChange(n,s,p,o),r=n,a=o,n=null,o=null):s.prop("textContent").match(new RegExp(i.options.currentLanguagePattern))&&(o=s))}r=null,a=null,n=null,o=null}})),this._registerKnownTextNodes(),[r,a]},r._registerKnownTextNodes=function(){this._textNodesWithKnownTranslation={};var e=this;this.$domNodes.knownTranslation.find(":not(iframe)").contents().each((function(){var t=(0,l.$)(this);!e.options.replaceDomNodeNames.includes(t.prop("nodeName").toLowerCase())&&t.Tools("text").trim()&&0===t.parents(e.options.replaceDomNodeNames.join()).length&&Object.prototype.hasOwnProperty.call(e.knownTranslations,t.Tools("text").trim())&&(e._addTextNodeToFade(t),e._textNodesWithKnownTranslation[e.knownTranslations[t.prop("textContent").trim()]]=Object.prototype.hasOwnProperty.call(e._textNodesWithKnownTranslation,e.knownTranslations[t.prop("textContent").trim()])?e._textNodesWithKnownTranslation[e.knownTranslations[t.prop("textContent").trim()]].add(this):t)}))},r._normalizeLanguage=function(e){for(var t in this.options.languageMapping)if(Object.prototype.hasOwnProperty.call(this.options.languageMapping,t)&&(this.options.languageMapping[t].includes(t.toLowerCase())||this.options.languageMapping[t].push(t.toLowerCase()),this.options.languageMapping[t].includes(e.toLowerCase())))return t;return this.options.default},r._determineUsefulLanguage=function(){var e,t,n,o;return this.options.initial?o=this.options.initial:l.$.global.window&&(null!=(e=l.$.global.window.localStorage)&&e.getItem(this.options.sessionDescription)?(o=l.$.global.window.localStorage.getItem(this.options.sessionDescription),this.debug('Determine "'+o+'", because of local storage information.')):null!=(t=l.$.global.window.navigator)&&t.language&&(o=l.$.global.window.navigator.language,this.debug('Determine "'+o+'", because of browser settings.'))),o||(o=this.options.default,this.debug('Determine "'+o+'", because of default option.')),o=this._normalizeLanguage(o),this.options.selection.length&&!this.options.selection.includes(o)&&(this.debug('"'+o+'" isn\'t one of the allowed languages. Set language to "'+this.options.selection[0]+'".'),o=this.options.selection[0]),null!=(n=l.$.global.window)&&n.localStorage&&l.$.global.window.localStorage.setItem(this.options.sessionDescription,o),o},r._addTextNodeToFade=function(e){var t=e.parent();this._$domNodeToFade=this._$domNodeToFade?this._$domNodeToFade.add(t):t},r._registerTextNodeToChange=function(e,t,n,o){this._addTextNodeToFade(e),t&&this._replacements.push({$textNodeToTranslate:e,$nodeToReplace:t,textToReplace:n[2],$currentLanguageDomNode:o})},r._ensureLastTextNodeHavingLanguageIndicator=function(e,t,n){if(e&&!t){var o=this.currentLanguage;n&&(o=this.options.default),t=(0,l.$)("\x3c!--"+o+"--\x3e"),e.after(t)}return t},r._switchLanguage=function(e){for(var t,n=this,o=function(){var o=t.value,r=o.$textNodeToTranslate.html();"#text"===o.$textNodeToTranslate.prop("nodeName")&&(r=o.$textNodeToTranslate.prop("textContent"));var a=r.trim();if(!n.options.templateDelimiter||!a.endsWith(n.options.templateDelimiter.post)&&n.options.templateDelimiter.post){var i=o.$currentLanguageDomNode;if(!i){i=(0,l.$)("body");var s=!1;o.$textNodeToTranslate.parent().contents().each((function(){return s?(o.$currentLanguageDomNode=i=(0,l.$)(this),!1):void(this===o.$textNodeToTranslate[0]&&(s=!0))}))}var u=i.prop("textContent");e===u&&n.warn('Text node "'+o.textToReplace+'" is marked as "'+u+'" and has same translation language as it already is.');var c=o.$nodeToReplace.prop("nodeName").toLowerCase();"#comment"===c?o.$textNodeToTranslate.after((0,l.$)("\x3c!--"+u+":"+r+"--\x3e")):o.$textNodeToTranslate.after((0,l.$)("<"+c+">"+u+":"+r+"</"+c+">").hide()),o.$textNodeToTranslate.after((0,l.$)("\x3c!--"+e+"--\x3e")),"#text"===o.$textNodeToTranslate.prop("nodeName")?o.$textNodeToTranslate.prop("textContent",o.textToReplace):o.$textNodeToTranslate.html(o.textToReplace),i.remove(),o.$nodeToReplace.remove()}},r=c(this._replacements);!(t=r()).done;)o();for(var a in this._textNodesWithKnownTranslation)Object.prototype.hasOwnProperty.call(this._textNodesWithKnownTranslation,a)&&this._textNodesWithKnownTranslation[a].prop("textContent",a);"localStorage"in l.$.global&&l.$.global.localStorage.setItem(this.options.sessionDescription,e),this.currentLanguage=e},r._switchCurrentLanguageIndicator=function(e){(0,l.$)('a[href="#'+this.options.languageHashPrefix+this.currentLanguage+'"].'+this.options.currentLanguageIndicatorClassName).removeClass(this.options.currentLanguageIndicatorClassName),(0,l.$)('a[href="#'+this.options.languageHashPrefix+e+'"]').addClass(this.options.currentLanguageIndicatorClassName)},n}(l.BoundTools);d._defaultOptions={currentLanguageIndicatorClassName:"current",currentLanguagePattern:"^[a-z]{2}[A-Z]{2}$",default:"enUS",domNodes:{knownTranslation:"div.toc"},fadeEffect:!0,initial:null,languageHashPrefix:"lang-",languageMapping:{deDE:["de","de_de","de-de","german","deutsch"],enUS:["en","en_us","en-us"],enEN:["en_en","en-en","english"],frFR:["fr","fr_fr","fr-fr","french"]},lockDescription:"{1}Switch",name:"Internationalisation",onSwitched:u().noop,onEnsured:u().noop,onSwitch:u().noop,onEnsure:u().noop,preReplacementLanguagePattern:"^\\|({1})$",replaceDomNodeNames:["#text","lang-replace"],replacementDomNodeName:["#comment","lang-replacement"],replacementLanguagePattern:"^([a-z]{2}[A-Z]{2}):((.|\\s)*)$",selection:[],sessionDescription:"{1}",templateDelimiter:{pre:"{{",post:"}}"},textNodeParent:{hideAnimation:[{opacity:0},{duration:"fast"}],showAnimation:[{opacity:1},{duration:"fast"}]}},s.default=d,l.$.fn&&(l.$.fn.Internationalisation=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return u().controller(d,t,this)})}(),s}()}));